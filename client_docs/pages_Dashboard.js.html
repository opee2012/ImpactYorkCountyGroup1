<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/Dashboard.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/Dashboard.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useEffect } from "react";
import "../styles/Dashboard.css";
import DashboardAccordion from "../components/dashboard-accordion";
import { useDataHandle } from "../hooks/useData";
import { useLogout } from "../hooks/useLogout";
import { useAuthContext } from "../context/AuthContext";

/**
* The Dashboard component serves as the main interface for users and staff. It provides
* navigation through a sidebar, user actions in a top panel, and a content section
* for displaying data. It uses various hooks for authentication, data fetching,
* and state management.
* For users, the dashboard allows viewing data, searching, and filtering through the data.
* For staff, the dashboard provides the ability to log in and keep the data updated or make changes as needed.
* The dashboard also handles automatic data refresh in case of errors and provides a logout functionality.
* @returns {JSX.Element} The rendered Dashboard component.
*/

const Dashboard = () => {
  const { logout } = useLogout(); // Hook for logging out the user
  const [selectedMenuItem, setSelectedMenuItem] = useState(0); // State for tracking the selected menu item in the sidebar
  const { fetchData, isLoading, error } = useDataHandle(); // Custom hook for handling data fetching and state management
  const [searchInput, setSearchInput] = useState(""); // State for storing the user's search input for filtering data
  const [categories, setCategories] = useState(null); // State for storing fetched categories to be displayed in the sidebar
  const [tryRefresh, setTryRefresh] = useState(false); // State for triggering a data refresh in case of errors

  /**
  * Updates the search input state based on the user's input.
  * @param {React.ChangeEvent&lt;HTMLInputElement>} event - The input event triggered by the user's typing.
  */
  const handleChange = (event) => {
    setSearchInput(event.target.value);
  };

  /**
  * Updates the state to reflect the user's selection of a menu item in the sidebar.
  * @param {number} menuItemIndex - The index of the selected menu item.
  */
  const handleMenuItemClick = (menuItemIndex) => {
    setSelectedMenuItem(menuItemIndex);
  };

  const { state } = useAuthContext(); // Custom hook for accessing the current user's authentication state
  const { email, admin } = state || {}; // Destructuring to get email and admin status from the authentication state

  /**
  * Fetches categories data on component mount and whenever the tryRefresh state changes.
  * Updates the categories state with the fetched data. If an error occurs during data
  * fetching, it logs the error to the console and attempts to refresh the data.
  */
  useEffect(() => {
    fetchData()
      .then((data) => {
        setCategories(data.out);
      })
      .catch((error) => {
        console.error("Error fetching data:", error);
      });
  }, [tryRefresh]);

  /**
  * Sets up an interval to try refreshing the data every 5 seconds if there's an error.
  * Clears the interval when the component unmounts or when the error/tryRefresh state changes.
  * This ensures that the dashboard attempts to recover from errors by refreshing
  * the data periodically until the error is resolved.
  */
  useEffect(() => {
    const intervalId = setInterval(() => {
      if (error) setTryRefresh(!tryRefresh);
    }, 5000);
    return () => clearInterval(intervalId);
  }, [error, tryRefresh]);

  return (
    &lt;div className="dashboard-container">
      {/* Sidebar for navigation */}
      &lt;header className="sidebar">
        {/* Logo section */}
        &lt;div id="Logo">
          &lt;img src="IYC-dashboard-icon.png" alt="IYC" />
        &lt;/div>
        {/* Navigation menu */}
        &lt;h1>Menu&lt;/h1>
        &lt;ul>
          {categories
            ? categories.map((item, index) => {

                /**
                * Renders an individual list item (`&lt;li>`) for each category.
                * - key={index}: Provides a unique key for each list item.
                * - onClick: Updates the selected menu item when this item is clicked.
                * - className: Conditionally adds the 'highlighted' class if this item is the selected menu item.
                */
                return (
                  &lt;li
                    key={index}
                    onClick={() => handleMenuItemClick(index)}
                    {...selectedMenuItem === index ? { className: "highlighted" } : null}
                  >
                    {item.Category}
                  &lt;/li>
                );
              })
            : null}
        &lt;/ul>
      &lt;/header>
  
      {/* Top panel for user actions */}
      &lt;header className="top-panel">
        {/* Button for admin users to manage accounts */}
        {admin &amp;&amp; (
          &lt;button
            className="button button-center button-blue"
            onClick={() => window.location.assign("/user-management")}
          >
            Manage Accounts
          &lt;/button>
        )}
        {/* Button for logged-in users to change password */}
        {email &amp;&amp; (
          &lt;button
            className="button button-center button-purple"
            onClick={() => window.location.assign("/password")}
          >
            Change Password
          &lt;/button>
        )}
        {/* Button for logged-in users to upload data */}
        {email &amp;&amp; (
          &lt;button
            className="button button-center button-black"
            onClick={() => window.location.assign("/upload")}
          >
            Upload Data
          &lt;/button>
        )}
        {/* Button for logged-in users to logout */}
        {email &amp;&amp; (
          &lt;button className="button button-center button-red" onClick={() => logout()}>
            Logout
          &lt;/button>
        )}
        {/* Button for unauthenticated users to login */}
        {!email &amp;&amp; (
          &lt;button className="button button-center button-blue" onClick={() => window.location.assign("/login")}>
            Login
          &lt;/button>
        )}
        {/* Search bar */}
        &lt;div className="search-container">
          &lt;input
            className="search-textbox"
            type="text"
            style={{ paddingLeft: "10px" }}
            placeholder="Search for data..."
            onChange={handleChange}
            value={searchInput}
          />
          &lt;button type="submit" className="search-icon-submit">
            &lt;img src="search-icon.png" alt="search-icon" />
          &lt;/button>
        &lt;/div>
      &lt;/header>
  
      {/* Content section for displaying data */}
      &lt;div className="content-section">
        {/* Displays an error message if there's an error */}
        {error ? (
          &lt;p className="wrapper">{error}&lt;/p>
        ) : isLoading ? (
          /* Displays a loading message while data is being fetched */
          &lt;p className="wrapper">loading...&lt;/p>
        ) : categories ? (
          /* Displays data based on the selected category and search input */
          &lt;DashboardAccordion category={categories[selectedMenuItem]} searchInput={searchInput} />
        ) : null}
      &lt;/div>
    &lt;/div>
  );
};  

export default Dashboard;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#AuthContextProvider">AuthContextProvider</a></li><li><a href="global.html#ChangePasswordForm">ChangePasswordForm</a></li><li><a href="global.html#Dashboard">Dashboard</a></li><li><a href="global.html#DashboardAccordion">DashboardAccordion</a></li><li><a href="global.html#Edit">Edit</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#LoginForm">LoginForm</a></li><li><a href="global.html#MyDropzone">MyDropzone</a></li><li><a href="global.html#Upload">Upload</a></li><li><a href="global.html#UploadForm">UploadForm</a></li><li><a href="global.html#UserManagement">UserManagement</a></li><li><a href="global.html#authReducer">authReducer</a></li><li><a href="global.html#useAuthContext">useAuthContext</a></li><li><a href="global.html#useDataHandle">useDataHandle</a></li><li><a href="global.html#useEdit">useEdit</a></li><li><a href="global.html#useLogin">useLogin</a></li><li><a href="global.html#useLogout">useLogout</a></li><li><a href="global.html#usePassword">usePassword</a></li><li><a href="global.html#useUpload">useUpload</a></li><li><a href="global.html#useUserMan">useUserMan</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Fri Apr 12 2024 23:45:49 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
